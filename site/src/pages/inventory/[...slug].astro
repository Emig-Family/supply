---
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const inventory = await getCollection('inventory');
  return inventory.map((item) => ({
    params: { slug: item.slug },
  }));
}

const { slug } = Astro.params;
const item = await getEntry('inventory', slug);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{item.data.title} - Emig Supply</title>
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#3b82f6" />
  </head>
  <body class="bg-slate-100 text-slate-900 dark:bg-slate-900 dark:text-slate-100 transition-colors min-h-screen">
    <div class="container mx-auto px-4 py-12">
      <header class="text-center mb-12 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 py-8 px-8 rounded-2xl border border-slate-100 dark:border-slate-700">
        <a href="/" class="inline-block mb-4 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium">&larr; Back to Home</a>
        <h1 class="text-4xl font-extrabold mb-4 tracking-tight text-slate-900 dark:text-slate-100">{item.data.title}</h1>
        <p class="text-xl max-w-2xl mx-auto text-slate-700 dark:text-slate-300">{item.data.description}</p>
      </header>

      <div class="max-w-4xl mx-auto">
        <div class="bg-white dark:bg-slate-800 rounded-2xl overflow-hidden mb-8 border border-slate-100 dark:border-slate-700">
          <div class="relative h-96 md:h-[500px]">
            {item.data.images.map((image, imgIndex) => (
              <>
                <input
                  type="radio"
                  name={`carousel-${item.slug}`}
                  id={`slide-${item.slug}-${imgIndex}`}
                  class="hidden peer"
                  checked={imgIndex === 0}
                />
                <img
                  src={image}
                  alt={`${item.data.title} image ${imgIndex + 1}`}
                  class="w-full h-full object-cover absolute inset-0 opacity-0 peer-checked:opacity-100 transition-opacity duration-300"
                />
              </>
            ))}
            <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 flex space-x-3">
              {item.data.images.map((_, imgIndex) => (
                <label
                  for={`slide-${item.slug}-${imgIndex}`}
                  class="w-4 h-4 bg-white bg-opacity-50 rounded-full cursor-pointer hover:bg-opacity-75 transition-all duration-200 hover:scale-110"
                ></label>
              ))}
            </div>
          </div>
        </div>

        <div class="text-center">
          <a href={`mailto:supply@emig.family?subject=Inquiry about ${item.data.title}`} class="inline-block bg-blue-600 text-white hover:bg-blue-700 font-bold py-4 px-8 rounded-full text-lg transition-all duration-300 transform hover:-translate-y-1">Request This Item</a>
        </div>
      </div>

      <footer class="text-center mt-20 py-8 border-t border-gray-200 dark:border-gray-700">
        <p class="text-sm text-gray-500 dark:text-gray-400">Built by <a href="https://kwila.cloud" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium transition-colors">Kwila Cloud</a></p>
      </footer>
    </div>
  </body>
</html>